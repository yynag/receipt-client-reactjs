<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CDKÊâπÈáèÊü•ËØ¢Â∑•ÂÖ∑</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
      }

      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
        color: #2d3748;
        min-height: 100vh;
        padding: 5px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin: 0;
      }

      .container {
        width: 100%;
        max-width: 1000px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.5);
        display: flex;
        flex-direction: column;
        min-height: calc(100vh - 10px);
      }

      header {
        background: linear-gradient(to right, #4f46e5, #7c3aed);
        color: white;
        padding: 15px 30px;
        text-align: center;
        position: relative;
        overflow: hidden;
        flex-shrink: 0;
        border-radius: 20pxÔºå20pxÔºå0Ôºå0;
      }

      .header-pattern {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        opacity: 0.05;
        border-radius: 20pxÔºå20pxÔºå0Ôºå0;
        background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      }

      .language-switcher {
        position: absolute;
        top: 15px;
        right: 15px;
        display: flex;
        gap: 8px;
        z-index: 10;
      }

      .lang-btn {
        background: rgba(255, 255, 255, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        padding: 6px 12px;
        border-radius: 16px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.3s;
        position: relative;
        z-index: 10;
      }

      .lang-btn:hover,
      .lang-btn.active {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
      }

      .logo {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 8px;
        position: relative;
      }

      .logo-icon {
        font-size: 30px;
        margin-right: 12px;
        color: #10b981;
        background: white;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      h1 {
        font-size: 24px;
        margin-bottom: 4px;
        font-weight: 700;
      }

      .subtitle {
        font-size: 14px;
        opacity: 0.9;
        font-weight: 300;
      }

      .content {
        padding: 15px;
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      .main-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        min-height: 100%;
      }

      .bottom-content {
        margin-top: auto;
        padding: 20px 0;
      }

      .empty-placeholder {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        color: #718096;
        opacity: 0.6;
        min-height: 200px;
      }

      .empty-placeholder i {
        font-size: 4rem;
        margin-bottom: 20px;
        color: #4f46e5;
        opacity: 0.3;
      }

      .empty-placeholder h3 {
        font-size: 1.2rem;
        margin-bottom: 10px;
        color: #4f46e5;
      }

      .empty-placeholder p {
        font-size: 0.9rem;
        line-height: 1.5;
      }

      .section-title {
        font-size: 18px;
        color: #4f46e5;
        margin-bottom: 15px;
        padding-bottom: 8px;
        border-bottom: 2px solid #e1effe;
        position: relative;
        font-weight: 600;
      }

      .section-title:after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 60px;
        height: 2px;
        background: #4f46e5;
      }

      .input-area {
        background: #f7fafc;
        padding: 15px;
        border-radius: 16px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.04);
        margin-bottom: 15px;
        border: 1px solid #e2e8f0;
        flex-shrink: 0;
      }

      .input-title {
        font-weight: 600;
        margin-bottom: 12px;
        color: #4f46e5;
        font-size: 16px;
        display: flex;
        align-items: center;
      }

      .input-title i {
        margin-right: 10px;
      }

      textarea {
        width: 100%;
        height: 100px;
        padding: 12px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 14px;
        transition: all 0.3s;
        background: white;
        resize: vertical;
      }

      textarea:focus {
        border-color: #4f46e5;
        outline: none;
        box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
      }

      .input-hint {
        color: #718096;
        font-size: 12px;
        margin-top: 8px;
        line-height: 1.4;
      }

      .input-hint i {
        color: #f59e0b;
        margin-right: 6px;
      }

      .button-group {
        display: flex;
        gap: 15px;
        margin-top: 15px;
      }

      .btn {
        flex: 1;
        padding: 12px;
        border: none;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .btn-primary {
        background: linear-gradient(to right, #4f46e5, #7c3aed);
        color: white;
        box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(79, 70, 229, 0.4);
      }

      .btn-secondary {
        background: #f7fafc;
        color: #4f46e5;
        border: 2px solid #e2e8f0;
      }

      .btn-secondary:hover {
        background: #edf2f7;
        transform: translateY(-3px);
      }

      .btn i {
        margin-right: 10px;
      }

      .loading {
        display: inline-block;
        width: 16px;
        height: 16px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top: 2px solid white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .progress-bar {
        width: 100%;
        height: 4px;
        background: #e2e8f0;
        border-radius: 2px;
        overflow: hidden;
        margin: 16px 0;
        display: none;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(to right, #4f46e5, #7c3aed);
        width: 0%;
        transition: width 0.3s ease;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
        margin: 12px 0;
      }

      .stat-card {
        background: #f7fafc;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 12px;
        text-align: center;
        transition: all 0.2s ease;
      }

      .stat-card:hover {
        border-color: #4f46e5;
        transform: translateY(-2px);
      }

      .stat-card.valid {
        border-color: #10b981;
      }

      .stat-card.used {
        border-color: #f59e0b;
      }

      .stat-card.invalid {
        border-color: #ef4444;
      }

      .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: #2d3748;
        margin-bottom: 4px;
      }

      .stat-label {
        font-size: 0.875rem;
        color: #718096;
      }

      .results-section {
        margin-top: 12px;
        display: flex;
        flex-direction: column;
      }

      .copy-section {
        background: #f7fafc;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 12px;
        margin-bottom: 12px;
        flex-shrink: 0;
      }

      .copy-title {
        font-size: 14px;
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 12px;
      }

      .copy-buttons {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }

      .btn-copy {
        background: #10b981;
        color: white;
        padding: 6px 12px;
        border: none;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 4px;
      }

      .btn-copy:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .btn-copy.copied {
        background: #718096;
      }

      .copy-icon {
        width: 12px;
        height: 12px;
      }

      .tabs {
        display: flex;
        border-bottom: 1px solid #e2e8f0;
        margin-bottom: 12px;
        flex-shrink: 0;
      }

      .tab {
        padding: 8px 16px;
        background: none;
        border: none;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        color: #718096;
        border-bottom: 2px solid transparent;
        transition: all 0.2s ease;
      }

      .tab.active {
        color: #4f46e5;
        border-bottom-color: #4f46e5;
      }

      .tab:hover:not(.active) {
        color: #2d3748;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .results-list {
        overflow-y: auto;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        background: white;
        min-height: 120px;
        max-height: 200px;
      }

      .result-item {
        padding: 12px 16px;
        border-bottom: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: background-color 0.2s ease;
      }

      .result-item:hover {
        background: #f7fafc;
      }

      .result-item:last-child {
        border-bottom: none;
      }

      .result-code {
        font-family: 'Courier New', monospace;
        font-weight: 600;
        color: #2d3748;
      }

      .result-info {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 4px;
      }

      .result-status {
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .status-valid {
        background: rgba(16, 185, 129, 0.2);
        color: #10b981;
      }

      .status-used {
        background: rgba(245, 158, 11, 0.2);
        color: #f59e0b;
      }

      .status-invalid {
        background: rgba(239, 68, 68, 0.2);
        color: #ef4444;
      }

      .result-details {
        font-size: 0.75rem;
        color: #718096;
      }

      .empty-state {
        text-align: center;
        padding: 40px;
        color: #718096;
      }

      .empty-icon {
        font-size: 3rem;
        margin-bottom: 16px;
        opacity: 0.5;
      }

      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #10b981;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        transform: translateX(400px);
        transition: transform 0.3s ease;
      }

      .toast.show {
        transform: translateX(0);
      }

      .toast.warning {
        background: #f59e0b;
      }

      .toast.error {
        background: #ef4444;
      }

      .result-area {
        background: #f7fafc;
        padding: 25px;
        border-radius: 16px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.04);
        margin-top: 30px;
        border: 1px solid #e2e8f0;
        display: none;
      }

      .result-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .result-title {
        font-weight: 600;
        color: #4f46e5;
        font-size: 18px;
      }

      .result-count {
        background: #4f46e5;
        color: white;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 14px;
      }

      .result-table {
        width: 100%;
        border-collapse: collapse;
      }

      .result-table th {
        background: #edf2f7;
        padding: 12px 15px;
        text-align: left;
        font-weight: 600;
        color: #4a5568;
      }

      .result-table td {
        padding: 12px 15px;
        border-bottom: 1px solid #e2e8f0;
      }

      .result-table tr:last-child td {
        border-bottom: none;
      }

      .status-badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 500;
      }

      .status-valid {
        background: #c6f6d5;
        color: #22543d;
      }

      .status-invalid {
        background: #fed7d7;
        color: #742a2a;
      }

      footer {
        text-align: center;
        padding: 10px;
        color: #718096;
        font-size: 12px;
        background: #f7fafc;
        border-top: 1px solid #e2e8f0;
        flex-shrink: 0;
        border-radius: 0 0 20px 20px;
      }

      @media (max-width: 768px) {
        .container {
          max-width: 100%;
        }

        .content {
          padding: 20px;
        }

        header {
          padding: 20px;
        }

        h1 {
          font-size: 24px;
        }

        .subtitle {
          font-size: 14px;
        }

        .logo {
          flex-direction: column;
          text-align: center;
        }

        .logo-icon {
          margin-right: 0;
          margin-bottom: 10px;
        }

        .button-group {
          flex-direction: column;
        }

        .language-switcher {
          position: relative;
          top: 0;
          right: 0;
          justify-content: center;
          margin-bottom: 15px;
        }

        .result-table {
          display: block;
          overflow-x: auto;
        }
      }

      .ai-elements {
        display: flex;
        justify-content: center;
        margin: 10px 0;
        gap: 12px;
        flex-shrink: 0;
      }

      .ai-element {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #4f46e5;
        opacity: 0.6;
        animation: pulse 2s infinite;
      }

      .ai-element:nth-child(2) {
        animation-delay: 0.3s;
        background: #7c3aed;
      }

      .ai-element:nth-child(3) {
        animation-delay: 0.6s;
        background: #10b981;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
          opacity: 0.6;
        }
        50% {
          transform: scale(1.3);
          opacity: 1;
        }
        100% {
          transform: scale(1);
          opacity: 0.6;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="header-pattern"></div>
        <div class="language-switcher">
          <button class="lang-btn active" data-lang="zh-CN">ÁÆÄ‰Ωì</button>
          <button class="lang-btn" data-lang="zh-TW">ÁπÅÈ´î</button>
          <button class="lang-btn" data-lang="en">EN</button>
        </div>
        <div class="logo">
          <i class="fas fa-search-dollar logo-icon"></i>
          <div>
            <h1 data-i18n="title" id="sysTitle">CDKÊâπÈáèÊü•ËØ¢Â∑•ÂÖ∑</h1>
            <p class="subtitle" data-i18n="subtitle" id="sysDesc">ÊâπÈáèÊü•ËØ¢Â§ö‰∏™CDKÁöÑÊùÉÈôê‰ø°ÊÅØ</p>
          </div>
        </div>
      </header>

      <div class="content">
        <div class="main-content">
          <div class="input-area">
            <div class="input-title">
              <i class="fas fa-keyboard"></i> <span data-i18n="inputTitle" id="inputLabel">ËØ∑ËæìÂÖ•CDKÂ≠óÊÆµ</span>
            </div>
            <textarea
              id="cdkInput"
              data-i18n-placeholder="inputPlaceholder"
              placeholder="ËØ∑ËæìÂÖ•CDKÔºåÊØèË°å‰∏Ä‰∏™"
            ></textarea>
            <div class="input-hint">
              <i class="fas fa-info-circle"></i>
              <span id="inputHint">ËØ∑Âú®CDK‰∏≠Êü•ÁúãCDKÊï∞ÊçÆ‰ø°ÊÅØÔºåÊØèË°åËæìÂÖ•‰∏Ä‰∏™CDK‰ª£Á†Å</span>
            </div>

            <div class="button-group">
              <button class="btn btn-primary" id="queryBtn" data-i18n="queryButton">
                <span id="queryBtnText">ÂºÄÂßãÊü•ËØ¢</span>
                <div class="loading" id="queryLoading" style="display: none"></div>
              </button>
              <button class="btn btn-secondary" id="clearBtn" data-i18n="confirmButton">
                <i class="fas fa-check"></i> Ê∏ÖÁ©∫ËæìÂÖ•
              </button>
            </div>

            <div class="progress-bar" id="progressBar" style="display: none">
              <div class="progress-fill" id="progressFill"></div>
            </div>
          </div>

          <!-- ÁªüËÆ°Âå∫Âüü -->
          <div class="stats-grid" id="statsSection" style="display: none">
            <div class="stat-card">
              <div class="stat-number" id="totalCount">0</div>
              <div class="stat-label" id="totalLabel">ÊÄªÊï∞Èáè</div>
            </div>
            <div class="stat-card valid">
              <div class="stat-number" id="validCount">0</div>
              <div class="stat-label" id="validLabel">ÊúâÊïàCDK</div>
            </div>
            <div class="stat-card used">
              <div class="stat-number" id="usedCount">0</div>
              <div class="stat-label" id="usedLabel">Â∑≤‰ΩøÁî®</div>
            </div>
            <div class="stat-card invalid">
              <div class="stat-number" id="invalidCount">0</div>
              <div class="stat-label" id="invalidLabel">Êó†ÊïàCDK</div>
            </div>
          </div>

          <!-- ÁªìÊûúÂå∫Âüü -->
          <div class="results-section" id="resultsSection" style="display: none">
            <div class="copy-section">
              <div class="copy-title" id="copyTitle">‰∏ÄÈîÆÂ§çÂà∂CDK</div>
              <div class="copy-buttons">
                <button class="btn-copy" id="copyAllBtn">
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"
                    />
                  </svg>
                  <span id="copyAllText">Â§çÂà∂ÂÖ®ÈÉ®</span>
                </button>
                <button class="btn-copy" id="copyValidBtn">
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"
                    />
                  </svg>
                  <span id="copyValidText">Â§çÂà∂ÊúâÊïà</span>
                </button>
                <button class="btn-copy" id="copyUsedBtn">
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"
                    />
                  </svg>
                  <span id="copyUsedText">Â§çÂà∂Â∑≤‰ΩøÁî®</span>
                </button>
                <button class="btn-copy" id="copyInvalidBtn">
                  <svg class="copy-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path
                      d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"
                    />
                  </svg>
                  <span id="copyInvalidText">Â§çÂà∂Êó†Êïà</span>
                </button>
              </div>
            </div>

            <div class="tabs">
              <button class="tab active" data-tab="all" id="tabAll">ÂÖ®ÈÉ®</button>
              <button class="tab" data-tab="valid" id="tabValid">ÊúâÊïàCDK</button>
              <button class="tab" data-tab="used" id="tabUsed">Â∑≤‰ΩøÁî®</button>
              <button class="tab" data-tab="invalid" id="tabInvalid">Êó†ÊïàCDK</button>
            </div>

            <div class="tab-content active" id="tab-all">
              <div class="results-list" id="allList"></div>
            </div>
            <div class="tab-content" id="tab-valid">
              <div class="results-list" id="validList"></div>
            </div>
            <div class="tab-content" id="tab-used">
              <div class="results-list" id="usedList"></div>
            </div>
            <div class="tab-content" id="tab-invalid">
              <div class="results-list" id="invalidList"></div>
            </div>
          </div>

          <!-- Á©∫Âç†‰ΩçÂå∫Âüü -->
          <div class="empty-placeholder" id="emptyPlaceholder">
            <i class="fas fa-search"></i>
            <h3 id="emptyTitle">ÊöÇÊó†Êï∞ÊçÆ</h3>
            <p id="emptyDesc">ËØ∑ËæìÂÖ•CDK‰ª£Á†ÅÂπ∂ÁÇπÂáª"ÂºÄÂßãÊü•ËØ¢"</p>
          </div>

          <div class="bottom-content">
            <div class="ai-elements">
              <div class="ai-element"></div>
              <div class="ai-element"></div>
              <div class="ai-element"></div>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <p id="footerText">¬© 2023 CDKÊâπÈáèÊü•ËØ¢Â∑•ÂÖ∑ | Êèê‰æõÂÆâÂÖ®ÂèØÈù†ÁöÑCDKÊü•ËØ¢ÊúçÂä°</p>
      </footer>
    </div>

    <div class="toast" id="toast"></div>

    <script>
      const langData = {
        'zh-CN': {
          sysTitle: 'CDKÊâπÈáèÊü•ËØ¢Â∑•ÂÖ∑',
          sysDesc: 'Âø´ÈÄüÊü•ËØ¢Â§ö‰∏™CDKÁöÑÁä∂ÊÄÅ‰ø°ÊÅØ',
          inputLabel: 'ËæìÂÖ•CDKÂàóË°®',
          inputHint: 'ËØ∑Âú®CDK‰∏≠Êü•ÁúãCDKÊï∞ÊçÆ‰ø°ÊÅØÔºåÊØèË°åËæìÂÖ•‰∏Ä‰∏™CDK‰ª£Á†Å',
          inputPlaceholder: 'ËØ∑ËæìÂÖ•CDKÔºåÊØèË°å‰∏Ä‰∏™Ôºö\nGPTXXXXXXXXXXXXXX\nGPTYYYYYYYYYYYYYY\nGPTZZZZZZZZZZZZZZ',
          queryBtn: 'ÂºÄÂßãÊü•ËØ¢',
          queryingBtn: 'Êü•ËØ¢‰∏≠...',
          clearBtn: 'Ê∏ÖÁ©∫ËæìÂÖ•',
          copyAllBtn: 'Â§çÂà∂ÂÖ®ÈÉ®',
          copyValidBtn: 'Â§çÂà∂ÊúâÊïà',
          copyUsedBtn: 'Â§çÂà∂Â∑≤‰ΩøÁî®',
          copyInvalidBtn: 'Â§çÂà∂Êó†Êïà',
          copyTitle: '‰∏ÄÈîÆÂ§çÂà∂CDK',
          tabAll: 'ÂÖ®ÈÉ®',
          tabValid: 'ÊúâÊïàCDK',
          tabUsed: 'Â∑≤‰ΩøÁî®',
          tabInvalid: 'Êó†ÊïàCDK',
          totalLabel: 'ÊÄªÊï∞Èáè',
          validLabel: 'ÊúâÊïàCDK',
          usedLabel: 'Â∑≤‰ΩøÁî®',
          invalidLabel: 'Êó†ÊïàCDK',
          statusValid: 'ÊúâÊïà',
          statusUsed: 'Â∑≤‰ΩøÁî®',
          statusInvalid: 'Êó†Êïà',
          userLabel: 'Áî®Êà∑',
          timeLabel: 'Êó∂Èó¥',
          emptyTitle: 'ÊöÇÊó†Êï∞ÊçÆ',
          emptyDesc: 'ËØ∑ËæìÂÖ•CDK‰ª£Á†ÅÂπ∂ÁÇπÂáª‚ÄúÂºÄÂßãÊü•ËØ¢‚Äù',
          noValidCDK: 'ÊöÇÊó†ÊúâÊïàCDK',
          noUsedCDK: 'ÊöÇÊó†Â∑≤‰ΩøÁî®CDK',
          noInvalidCDK: 'ÊöÇÊó†Êó†ÊïàCDK',
          noCDKToCopy: 'Ê≤°ÊúâÂèØÂ§çÂà∂ÁöÑCDK',
          copySuccess: (count) => `Â∑≤Â§çÂà∂ ${count} ‰∏™CDK`,
          copyFailed: 'Â§çÂà∂Â§±Ë¥•',
          copied: 'Â∑≤Â§çÂà∂',
          inputEmpty: 'ËØ∑ËæìÂÖ•CDKÂàóË°®',
          inputInvalid: 'ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑCDK',
          networkError: 'ÁΩëÁªúÈîôËØØ',
          requestTimeout: 'ËØ∑Ê±ÇË∂ÖÊó∂',
          footerText: '¬© 2023 CDKÊâπÈáèÊü•ËØ¢Â∑•ÂÖ∑ | Êèê‰æõÂÆâÂÖ®ÂèØÈù†ÁöÑCDKÊü•ËØ¢ÊúçÂä°',
          // APIÈîôËØØÊ∂àÊÅØÁøªËØë
          errorMessages: {
            Âç°ÂØÜÂ∑≤Ë¢´‰ΩøÁî®: 'Âç°ÂØÜÂ∑≤Ë¢´‰ΩøÁî®',
            Êó†ÊïàCDK: 'Êó†ÊïàCDK',
            Âç°ÂØÜ‰∏çÂ≠òÂú®: 'Âç°ÂØÜ‰∏çÂ≠òÂú®',
            ÁΩëÁªúÈîôËØØ: 'ÁΩëÁªúÈîôËØØ',
            ËØ∑Ê±ÇË∂ÖÊó∂: 'ËØ∑Ê±ÇË∂ÖÊó∂',
          },
        },
        'zh-TW': {
          sysTitle: 'CDKÊâπÈáèÊü•Ë©¢Â∑•ÂÖ∑',
          sysDesc: 'Âø´ÈÄüÊü•Ë©¢Â§öÂÄãCDKÁöÑÁãÄÊÖã‰ø°ÊÅØ',
          inputLabel: 'Ëº∏ÂÖ•CDKÂàóË°®',
          inputHint: 'Ë´ãÂú®CDK‰∏≠Êü•ÁúãCDKÊï∏Êìö‰ø°ÊÅØÔºåÊØèË°åËº∏ÂÖ•‰∏ÄÂÄãCDK‰ª£Á¢º',
          inputPlaceholder: 'Ë´ãËº∏ÂÖ•CDKÔºåÊØèË°å‰∏ÄÂÄãÔºö\nGPTXXXXXXXXXXXXXX\nGPTYYYYYYYYYYYYYY\nGPTZZZZZZZZZZZZZZ',
          queryBtn: 'ÈñãÂßãÊü•Ë©¢',
          queryingBtn: 'Êü•Ë©¢‰∏≠...',
          clearBtn: 'Ê∏ÖÁ©∫Ëº∏ÂÖ•',
          copyAllBtn: 'Ë§áË£ΩÂÖ®ÈÉ®',
          copyValidBtn: 'Ë§áË£ΩÊúâÊïà',
          copyUsedBtn: 'Ë§áË£ΩÂ∑≤‰ΩøÁî®',
          copyInvalidBtn: 'Ë§áË£ΩÁÑ°Êïà',
          copyTitle: '‰∏ÄÈçµË§áË£ΩCDK',
          tabAll: 'ÂÖ®ÈÉ®',
          tabValid: 'ÊúâÊïàCDK',
          tabUsed: 'Â∑≤‰ΩøÁî®',
          tabInvalid: 'ÁÑ°ÊïàCDK',
          totalLabel: 'Á∏ΩÊï∏Èáè',
          validLabel: 'ÊúâÊïàCDK',
          usedLabel: 'Â∑≤‰ΩøÁî®',
          invalidLabel: 'ÁÑ°ÊïàCDK',
          statusValid: 'ÊúâÊïà',
          statusUsed: 'Â∑≤‰ΩøÁî®',
          statusInvalid: 'ÁÑ°Êïà',
          userLabel: 'Áî®Êà∂',
          timeLabel: 'ÊôÇÈñì',
          emptyTitle: 'Êö´ÁÑ°Êï∏Êìö',
          emptyDesc: 'Ë´ãËº∏ÂÖ•CDK‰ª£Á¢º‰∏¶ÈªûÊìä„ÄåÈñãÂßãÊü•Ë©¢„Äç',
          noValidCDK: 'Êö´ÁÑ°ÊúâÊïàCDK',
          noUsedCDK: 'Êö´ÁÑ°Â∑≤‰ΩøÁî®CDK',
          noInvalidCDK: 'Êö´ÁÑ°ÁÑ°ÊïàCDK',
          noCDKToCopy: 'Ê≤íÊúâÂèØË§áË£ΩÁöÑCDK',
          copySuccess: (count) => `Â∑≤Ë§áË£Ω ${count} ÂÄãCDK`,
          copyFailed: 'Ë§áË£ΩÂ§±Êïó',
          copied: 'Â∑≤Ë§áË£Ω',
          inputEmpty: 'Ë´ãËº∏ÂÖ•CDKÂàóË°®',
          inputInvalid: 'Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑCDK',
          networkError: 'Á∂≤Áµ°ÈåØË™§',
          requestTimeout: 'Ë´ãÊ±ÇË∂ÖÊôÇ',
          footerText: '¬© 2023 CDKÊâπÈáèÊü•Ë©¢Â∑•ÂÖ∑ | Êèê‰æõÂÆâÂÖ®ÂèØÈù†ÁöÑCDKÊü•Ë©¢ÊúçÂãô',
          // APIÈåØË™§Ê∂àÊÅØÁøªË≠Ø
          errorMessages: {
            Âç°ÂØÜÂ∑≤Ë¢´‰ΩøÁî®: 'Âç°ÂØÜÂ∑≤Ë¢´‰ΩøÁî®',
            ÁÑ°ÊïàCDK: 'ÁÑ°ÊïàCDK',
            Âç°ÂØÜ‰∏çÂ≠òÂú®: 'Âç°ÂØÜ‰∏çÂ≠òÂú®',
            Á∂≤Áµ°ÈåØË™§: 'Á∂≤Áµ°ÈåØË™§',
            Ë´ãÊ±ÇË∂ÖÊôÇ: 'Ë´ãÊ±ÇË∂ÖÊôÇ',
          },
        },
        en: {
          sysTitle: 'CDK Batch Query Tool',
          sysDesc: 'Quickly check multiple CDK status',
          inputLabel: 'Input CDK List',
          inputHint: 'Please check CDK data info in CDK, enter one CDK code per line',
          inputPlaceholder: 'Enter CDK, one per line:\nGPTXXXXXXXXXXXXXX\nGPTYYYYYYYYYYYYYY\nGPTZZZZZZZZZZZZZZ',
          queryBtn: 'Start Query',
          queryingBtn: 'Querying...',
          clearBtn: 'Clear Input',
          copyAllBtn: 'Copy All',
          copyValidBtn: 'Copy Valid',
          copyUsedBtn: 'Copy Used',
          copyInvalidBtn: 'Copy Invalid',
          copyTitle: 'Quick Copy CDK',
          tabAll: 'All',
          tabValid: 'Valid CDK',
          tabUsed: 'Used',
          tabInvalid: 'Invalid',
          totalLabel: 'Total',
          validLabel: 'Valid CDK',
          usedLabel: 'Used',
          invalidLabel: 'Invalid',
          statusValid: 'Valid',
          statusUsed: 'Used',
          statusInvalid: 'Invalid',
          userLabel: 'User',
          timeLabel: 'Time',
          emptyTitle: 'No Data',
          emptyDesc: 'Please enter CDK codes and click "Start Query"',
          noValidCDK: 'No Valid CDK',
          noUsedCDK: 'No Used CDK',
          noInvalidCDK: 'No Invalid CDK',
          noCDKToCopy: 'No CDK to Copy',
          copySuccess: (count) => `Copied ${count} CDK(s)`,
          copyFailed: 'Copy Failed',
          copied: 'Copied',
          inputEmpty: 'Please Input CDK List',
          inputInvalid: 'Please Input Valid CDK',
          networkError: 'Network Error',
          requestTimeout: 'Request Timeout',
          footerText: '¬© 2023 CDK Batch Query Tool | Providing secure and reliable CDK query services',
          // API error message translations
          errorMessages: {
            Âç°ÂØÜÂ∑≤Ë¢´‰ΩøÁî®: 'Card key has been used',
            ÁÑ°ÊïàCDK: 'Invalid CDK',
            Âç°ÂØÜ‰∏çÂ≠òÂú®: 'Card key does not exist',
            Á∂≤Áµ°ÈåØË™§: 'Network Error',
            Ë´ãÊ±ÇË∂ÖÊôÇ: 'Request Timeout',
          },
        },
      };

      let currentLang = 'zh-CN';

      function setLang(lang) {
        currentLang = lang;
        const t = langData[lang];

        // Êõ¥Êñ∞ËØ≠Ë®ÄÊåâÈíÆÁä∂ÊÄÅ
        document.querySelectorAll('.lang-btn').forEach((btn) => btn.classList.remove('active'));
        document.querySelector(`[data-lang="${lang}"]`).classList.add('active');

        // Êõ¥Êñ∞ÊâÄÊúâÊñáÊú¨
        document.getElementById('sysTitle').textContent = t.sysTitle;
        document.getElementById('sysDesc').textContent = t.sysDesc;
        document.getElementById('inputLabel').textContent = t.inputLabel;
        document.getElementById('inputHint').textContent = t.inputHint;
        document.getElementById('cdkInput').placeholder = t.inputPlaceholder;
        document.getElementById('queryBtnText').textContent = t.queryBtn;
        document.getElementById('clearBtn').textContent = t.clearBtn;
        document.getElementById('footerText').textContent = t.footerText;

        // Êõ¥Êñ∞Â§çÂà∂ÊåâÈíÆÊñáÊú¨
        document.getElementById('copyTitle').textContent = t.copyTitle;
        document.getElementById('copyAllText').textContent = t.copyAllBtn;
        document.getElementById('copyValidText').textContent = t.copyValidBtn;
        document.getElementById('copyUsedText').textContent = t.copyUsedBtn;
        document.getElementById('copyInvalidText').textContent = t.copyInvalidBtn;

        // Êõ¥Êñ∞Ê†áÁ≠æÈ°µÊñáÊú¨
        document.getElementById('tabAll').textContent = t.tabAll;
        document.getElementById('tabValid').textContent = t.tabValid;
        document.getElementById('tabUsed').textContent = t.tabUsed;
        document.getElementById('tabInvalid').textContent = t.tabInvalid;

        // Êõ¥Êñ∞ÁªüËÆ°Ê†áÁ≠æ
        document.getElementById('totalLabel').textContent = t.totalLabel;
        document.getElementById('validLabel').textContent = t.validLabel;
        document.getElementById('usedLabel').textContent = t.usedLabel;
        document.getElementById('invalidLabel').textContent = t.invalidLabel;

        // Êõ¥Êñ∞Á©∫Áä∂ÊÄÅÊñáÊú¨
        document.getElementById('emptyTitle').textContent = t.emptyTitle;
        document.getElementById('emptyDesc').textContent = t.emptyDesc;

        // Â¶ÇÊûúÊúâÁªìÊûúÔºåÈáçÊñ∞Ê∏≤ÊüìÁªìÊûú
        if (window.cdkQueryTool && window.cdkQueryTool.cdkResults.length > 0) {
          window.cdkQueryTool.renderResults();
        }
      }

      class CDKQueryTool {
        constructor() {
          this.cdkResults = [];
          this.isQuerying = false;
          this.init();
        }

        init() {
          this.bindEvents();
          this.updateInitialLabels();
          this.resetLoadingState();
        }

        resetLoadingState() {
          // Á°Æ‰øùÈ°µÈù¢ÂàùÂßãÂåñÊó∂loadingÊòØÈöêËóèÁöÑ
          const loading = document.getElementById('queryLoading');
          const btn = document.getElementById('queryBtn');
          const text = document.getElementById('queryBtnText');
          const progressBar = document.getElementById('progressBar');
          const aiElements = document.querySelector('.ai-elements');

          if (loading) {
            loading.style.display = 'none';
            loading.style.visibility = 'hidden';
            loading.style.opacity = '0';
          }

          if (btn) {
            btn.disabled = false;
          }

          if (text) {
            text.textContent = langData[currentLang]?.queryBtn || 'ÂºÄÂßãÊü•ËØ¢';
          }

          if (progressBar) {
            progressBar.style.display = 'none';
          }

          // ÈöêËóèAIÂä®ÁîªÂÖÉÁ¥†
          if (aiElements) {
            aiElements.style.display = 'none';
          }

          // ÈáçÁΩÆÊü•ËØ¢Áä∂ÊÄÅ
          this.isQuerying = false;
        }

        updateInitialLabels() {
          const t = langData[currentLang];
          document.getElementById('sysTitle').textContent = t.sysTitle;
          document.getElementById('sysDesc').textContent = t.sysDesc;
          document.getElementById('inputLabel').textContent = t.inputLabel;
          document.getElementById('inputHint').textContent = t.inputHint;
          document.getElementById('cdkInput').placeholder = t.inputPlaceholder;
          document.getElementById('queryBtnText').textContent = t.queryBtn;
          document.getElementById('clearBtn').textContent = t.clearBtn;
          document.getElementById('footerText').textContent = t.footerText;

          // Êõ¥Êñ∞Â§çÂà∂ÊåâÈíÆÊñáÊú¨
          document.getElementById('copyTitle').textContent = t.copyTitle;
          document.getElementById('copyAllText').textContent = t.copyAllBtn;
          document.getElementById('copyValidText').textContent = t.copyValidBtn;
          document.getElementById('copyUsedText').textContent = t.copyUsedBtn;
          document.getElementById('copyInvalidText').textContent = t.copyInvalidBtn;

          // Êõ¥Êñ∞Ê†áÁ≠æÈ°µÊñáÊú¨
          document.getElementById('tabAll').textContent = t.tabAll;
          document.getElementById('tabValid').textContent = t.tabValid;
          document.getElementById('tabUsed').textContent = t.tabUsed;
          document.getElementById('tabInvalid').textContent = t.tabInvalid;

          // Êõ¥Êñ∞ÁªüËÆ°Ê†áÁ≠æ
          document.getElementById('totalLabel').textContent = t.totalLabel;
          document.getElementById('validLabel').textContent = t.validLabel;
          document.getElementById('usedLabel').textContent = t.usedLabel;
          document.getElementById('invalidLabel').textContent = t.invalidLabel;

          // Êõ¥Êñ∞Á©∫Áä∂ÊÄÅÊñáÊú¨
          document.getElementById('emptyTitle').textContent = t.emptyTitle;
          document.getElementById('emptyDesc').textContent = t.emptyDesc;
        }

        bindEvents() {
          document.getElementById('queryBtn').addEventListener('click', () => this.startQuery());
          document.getElementById('clearBtn').addEventListener('click', () => this.clearInput());

          // Ê†áÁ≠æÈ°µÂàáÊç¢
          document.querySelectorAll('.tab').forEach((tab) => {
            tab.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
          });

          // Â§çÂà∂ÊåâÈíÆ‰∫ã‰ª∂
          document.getElementById('copyAllBtn').addEventListener('click', () => this.copyCDKs('all'));
          document.getElementById('copyValidBtn').addEventListener('click', () => this.copyCDKs('valid'));
          document.getElementById('copyUsedBtn').addEventListener('click', () => this.copyCDKs('used'));
          document.getElementById('copyInvalidBtn').addEventListener('click', () => this.copyCDKs('invalid'));
        }

        clearInput() {
          document.getElementById('cdkInput').value = '';
          this.hideResults();
          this.resetLoadingState();
          // Á°Æ‰øùÊ∏ÖÁ©∫Êó∂AIÂä®Áîª‰πüÈöêËóè
          const aiElements = document.querySelector('.ai-elements');
          if (aiElements) {
            aiElements.style.display = 'none';
          }
        }

        hideResults() {
          document.getElementById('statsSection').style.display = 'none';
          document.getElementById('resultsSection').style.display = 'none';
          document.getElementById('emptyPlaceholder').style.display = 'flex';
        }

        showResults() {
          document.getElementById('statsSection').style.display = 'grid';
          document.getElementById('resultsSection').style.display = 'block';
          document.getElementById('emptyPlaceholder').style.display = 'none';
        }

        async startQuery() {
          if (this.isQuerying) return;

          const input = document.getElementById('cdkInput').value.trim();
          const t = langData[currentLang];

          if (!input) {
            this.showToast(t.inputEmpty, 'warning');
            return;
          }

          const cdkList = input
            .split('\n')
            .map((line) => line.trim())
            .filter((line) => line.length > 0);

          if (cdkList.length === 0) {
            this.showToast(t.inputInvalid, 'warning');
            return;
          }

          // Èò≤ÈáçÂ§çÊü•ËØ¢Êú∫Âà∂
          this.isQuerying = true;
          this.cdkResults = [];

          try {
            // Á´ãÂç≥ÊòæÁ§∫loading
            this.updateQueryButton(true);
            this.showProgressBar();
            this.hideResults();

            const response = await fetch(
              `https://receipt-api.nitro.xin/cdks/public/check-usage/${cdkList.map(encodeURIComponent).join(',')}`,
              {
                method: 'GET',
              },
            );
            if (!response.ok) {
              throw new Error('Failed to check CDKs: ' + (await response.text()));
            }
            const data = await response.json();

            this.cdkResults = data.map((cdk) => {
              return {
                card_key: cdk.code,
                status: cdk.used ? 1 : 0,
                status_text: cdk.used ? 'Â∑≤‰ΩøÁî®' : 'ÊúâÊïà',
                user_id: cdk.user || '',
                used_at: cdk.redeem_time || '',
              };
            });

            const progress = ((this.cdkResults.length / cdkList.length) * 100).toFixed(0);
            document.getElementById('progressFill').style.width = `${progress}%`;

            this.displayResults();
          } finally {
            // Á°Æ‰øùÊó†ËÆ∫ÊàêÂäüÊàñÂ§±Ë¥•ÈÉΩ‰ºöÈöêËóèloading
            this.isQuerying = false;
            this.updateQueryButton(false);
            this.hideProgressBar();
          }
        }

        updateQueryButton(isLoading) {
          const btn = document.getElementById('queryBtn');
          const text = document.getElementById('queryBtnText');
          const loading = document.getElementById('queryLoading');
          const aiElements = document.querySelector('.ai-elements');

          // Ê∑ªÂä†ÂÖÉÁ¥†Â≠òÂú®ÊÄßÈ™åËØÅ
          if (!btn || !text || !loading) {
            console.error('Loading elements not found:', { btn: !!btn, text: !!text, loading: !!loading });
            return;
          }

          if (isLoading) {
            btn.disabled = true;
            text.textContent = langData[currentLang].queryingBtn;
            loading.style.display = 'inline-block';
            loading.style.visibility = 'visible';
            loading.style.opacity = '1';

            // ÊòæÁ§∫AIÂä®ÁîªÂÖÉÁ¥†
            if (aiElements) {
              aiElements.style.display = 'flex';
            }
          } else {
            btn.disabled = false;
            text.textContent = langData[currentLang].queryBtn;
            loading.style.display = 'none';
            loading.style.visibility = 'hidden';
            loading.style.opacity = '0';

            // ÈöêËóèAIÂä®ÁîªÂÖÉÁ¥†
            if (aiElements) {
              aiElements.style.display = 'none';
            }

            // ‰ΩøÁî®setTimeoutÂú®Áü≠Êó∂Èó¥ÂêéÊÅ¢Â§çÊ≠£Â∏∏ÁöÑCSSÂ±ûÊÄß
            setTimeout(() => {
              if (loading && loading.style.display === 'none') {
                loading.style.visibility = '';
                loading.style.opacity = '';
              }
            }, 100);
          }
        }

        showProgressBar() {
          document.getElementById('progressBar').style.display = 'block';
        }

        hideProgressBar() {
          document.getElementById('progressBar').style.display = 'none';
        }

        displayResults() {
          this.updateStats();
          this.renderResults();
          this.showResults();
        }

        updateStats() {
          const total = this.cdkResults.length;
          const valid = this.cdkResults.filter((r) => r.status === 0).length;
          const used = this.cdkResults.filter((r) => r.status === 1).length;
          const invalid = this.cdkResults.filter((r) => r.status === -1).length;

          document.getElementById('totalCount').textContent = total;
          document.getElementById('validCount').textContent = valid;
          document.getElementById('usedCount').textContent = used;
          document.getElementById('invalidCount').textContent = invalid;
        }

        renderResults() {
          const allList = document.getElementById('allList');
          const validList = document.getElementById('validList');
          const usedList = document.getElementById('usedList');
          const invalidList = document.getElementById('invalidList');

          [allList, validList, usedList, invalidList].forEach((list) => {
            list.innerHTML = '';
          });

          this.cdkResults.forEach((result) => {
            const item = this.createResultItem(result);
            allList.appendChild(item.cloneNode(true));

            if (result.status === 0) {
              validList.appendChild(item.cloneNode(true));
            } else if (result.status === 1) {
              usedList.appendChild(item.cloneNode(true));
            } else {
              invalidList.appendChild(item.cloneNode(true));
            }
          });

          this.handleEmptyStates();
        }

        createResultItem(result) {
          const item = document.createElement('div');
          item.className = 'result-item';

          const statusClass =
            result.status === 0 ? 'status-valid' : result.status === 1 ? 'status-used' : 'status-invalid';

          const t = langData[currentLang];
          const statusText = result.status === 0 ? t.statusValid : result.status === 1 ? t.statusUsed : t.statusInvalid;

          let detailsHtml = '';
          if (result.status === 1 && result.user_id) {
            detailsHtml += `<div class="result-details">${t.userLabel}: ${result.user_id}</div>`;
          }
          if (result.status === 1 && result.used_at) {
            detailsHtml += `<div class="result-details">${t.timeLabel}: ${result.used_at}</div>`;
          }
          if (result.status === -1) {
            // ÁøªËØëAPIÈîôËØØÊ∂àÊÅØ
            const translatedMessage =
              t.errorMessages && t.errorMessages[result.status_text]
                ? t.errorMessages[result.status_text]
                : result.status_text;
            detailsHtml += `<div class="result-details">${translatedMessage}</div>`;
          }

          item.innerHTML = `
                    <div class="result-code">${result.card_key}</div>
                    <div class="result-info">
                        <span class="result-status ${statusClass}">${statusText}</span>
                        ${detailsHtml}
                    </div>
                `;

          return item;
        }

        handleEmptyStates() {
          const t = langData[currentLang];
          const lists = [
            { element: document.getElementById('validList'), message: t.noValidCDK },
            { element: document.getElementById('usedList'), message: t.noUsedCDK },
            { element: document.getElementById('invalidList'), message: t.noInvalidCDK },
          ];

          lists.forEach(({ element, message }) => {
            if (element.children.length === 0) {
              element.innerHTML = `
                            <div class="empty-state">
                                <div class="empty-icon">üì≠</div>
                                <div>${message}</div>
                            </div>
                        `;
            }
          });
        }

        switchTab(tabName) {
          document.querySelectorAll('.tab').forEach((tab) => {
            tab.classList.remove('active');
          });
          document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

          document.querySelectorAll('.tab-content').forEach((content) => {
            content.classList.remove('active');
          });
          document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        copyCDKs(type) {
          let cdksToCopy = [];

          switch (type) {
            case 'all':
              cdksToCopy = this.cdkResults.map((r) => r.card_key);
              break;
            case 'valid':
              cdksToCopy = this.cdkResults.filter((r) => r.status === 0).map((r) => r.card_key);
              break;
            case 'used':
              cdksToCopy = this.cdkResults.filter((r) => r.status === 1).map((r) => r.card_key);
              break;
            case 'invalid':
              cdksToCopy = this.cdkResults.filter((r) => r.status === -1).map((r) => r.card_key);
              break;
          }

          const t = langData[currentLang];
          if (cdksToCopy.length === 0) {
            this.showToast(t.noCDKToCopy, 'warning');
            return;
          }

          const cdkText = cdksToCopy.join('\n');

          if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard
              .writeText(cdkText)
              .then(() => {
                this.showToast(t.copySuccess(cdksToCopy.length), 'success');
                this.animateCopyButton(type);
              })
              .catch(() => {
                this.fallbackCopy(cdkText, cdksToCopy.length);
              });
          } else {
            this.fallbackCopy(cdkText, cdksToCopy.length);
          }
        }

        fallbackCopy(text, count) {
          const textArea = document.createElement('textarea');
          textArea.value = text;
          textArea.style.position = 'fixed';
          textArea.style.left = '-999999px';
          document.body.appendChild(textArea);
          textArea.focus();
          textArea.select();

          try {
            document.execCommand('copy');
            this.showToast(langData[currentLang].copySuccess(count), 'success');
          } catch {
            this.showToast(langData[currentLang].copyFailed, 'error');
          }

          document.body.removeChild(textArea);
        }

        animateCopyButton(type) {
          const buttonId = `copy${type.charAt(0).toUpperCase() + type.slice(1)}Btn`;
          const button = document.getElementById(buttonId);

          button.classList.add('copied');
          const originalText = button.innerHTML;

          button.innerHTML = `
                    <svg class="copy-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                    </svg>
                    ${langData[currentLang].copied}
                `;

          setTimeout(() => {
            button.classList.remove('copied');
            button.innerHTML = originalText;
          }, 2000);
        }

        showToast(message, type = 'success') {
          const toast = document.getElementById('toast');
          toast.textContent = message;
          toast.className = `toast ${type}`;
          toast.classList.add('show');

          setTimeout(() => {
            toast.classList.remove('show');
          }, 3000);
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        // ÂàùÂßãÂåñÊü•ËØ¢Â∑•ÂÖ∑
        window.cdkQueryTool = new CDKQueryTool();

        // ‰∏∫ËØ≠Ë®ÄÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
        document.querySelectorAll('.lang-btn').forEach((button) => {
          button.addEventListener('click', function () {
            const lang = this.getAttribute('data-lang');
            setLang(lang);
          });
        });

        // ËÆæÁΩÆÈªòËÆ§ËØ≠Ë®Ä‰∏∫ÁÆÄ‰Ωì‰∏≠Êñá
        setLang('zh-CN');
      });
    </script>
  </body>
</html>
